<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Equipment Transfer Form</title>

<!-- jsPDF + html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #eef1f5;
        margin: 0;
        padding: 15px;
    }

    .container {
        background: #fff;
        padding: 25px;
        border: 2px solid #000;
        max-width: 950px;
        margin: auto;
        box-shadow: 0 0 10px rgba(0,0,0,0.15);
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #000;
        padding-bottom: 15px;
    }

    .header-text {
        text-align: center;
        flex-grow: 1;
    }

    .header-logo {
        width: 110px;
        height: auto;
    }

    .header-text h3, .header-text h4, .header-text h2 {
        margin: 3px 0;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
        margin-top: 15px;
    }

    th, td {
        border: 1px solid #000;
        padding: 8px;
    }

    th {
        background: #f2f2f2;
        font-weight: bold;
    }

    input, textarea {
        width: 100%;
        border: none;
        outline: none;
        background: transparent;
        resize: none;
        font-size: 14px;
    }

    .item-img {
        width: 100%;
        height: 80px;
        border: 1px solid #ccc;
        background: #fafafa;
        object-fit: contain;
    }

    .upload-btn {
        width: 100%;
        font-size: 12px;
        margin-top: 5px;
    }

    .btn {
        background: #0455a4;
        color: #fff;
        padding: 12px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-right: 10px;
    }

    .btn:hover { background: #033b75; }

    /* MOBILE RESPONSIVE */
    @media(max-width: 650px) {
        table, thead, tbody, th, td, tr {
            display: block;
        }
        th { display: none; }
        td {
            border: 1px solid #ddd;
            margin-bottom: 5px;
        }
        .header {
            flex-direction: column;
        }
        .header-logo {
            margin-bottom: 10px;
        }
    }
</style>

</head>

<body>

<div style="text-align: right; margin-bottom: 15px;">
    <button class="btn" onclick="addRow()">Add Row</button>
    <button class="btn" onclick="downloadPDF()">Save as PDF</button>
</div>

<div class="container" id="pdfSection">

    <!-- HEADER -->
    <div class="header">
        <div class="header-text">
            <h3>TU MANAGEMENT INVENTORY DEPARTMENT</h3>
            <h4>Al Ghazal Golf Club, Masdar City, Abu Dhabi</h4>
            <h2>Equipment Transfer Form</h2>
            <h4><strong>Form No: <span id="formID"></span></strong></h4>
        </div>

        <img class="header-logo"
             src="https://tuholdings.ae/wp-content/uploads/2024/06/tu-holding-group-1024x881.png"
             alt="Logo">
    </div>

    <!-- TRANSFER TABLE -->
    <table>
        <tr>
            <td><strong>Transferred From:</strong><input type="text" value="TU OFFICE"></td>
            <td><strong>Transferred To:</strong><input type="text" value="AL Ghazal Old Office"></td>
        </tr>
        <tr>
            <td><strong>Department:</strong><input type="text" value="INVENTORY"></td>
            <td><strong>Department:</strong><input type="text" value="INVENTORY"></td>
        </tr>
        <tr>
            <td colspan="2"><strong>Transfer Date:</strong><input type="date"></td>
        </tr>
    </table>

    <!-- EQUIPMENT TABLE -->
    <table id="equipmentTable">
        <thead>
            <tr>
                <th style="width:5%;">SL</th>
                <th style="width:20%;">Image</th>
                <th>Description</th>
                <th style="width:15%;">Qty</th>
                <th style="width:20%;">Remarks</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>

                <td>
                    <img class="item-img" id="img1" src="">
                    <input class="upload-btn" type="file" accept="image/*"
                           onchange="previewImage(event, 'img1')">
                </td>

                <td><textarea>Canon Office Printer</textarea></td>
                <td><input type="text" value="1 pcs"></td>
                <td><textarea></textarea></td>
            </tr>
        </tbody>
    </table>

    <!-- SIGNATURE -->
    <table>
        <tr>
            <td><strong>Issued By:</strong><input type="text" value="Roshith"></td>
            <td>Signature</td>
        </tr>
        <tr>
            <td><strong>Approved By:</strong><input type="text" value="Bimal Lamichhane"></td>
            <td>Signature</td>
        </tr>
        <tr>
            <td><strong>Transferred By:</strong><input type="text" value="Roshith"></td>
            <td>Signature</td>
        </tr>
        <tr>
            <td><strong>Received By:</strong><input type="text"></td>
            <td>Signature</td>
        </tr>
        <tr>
            <td><strong>Receiving Date:</strong><input type="date"></td>
            <td></td>
        </tr>
    </table>

</div>

<script>
// AUTO-GENERATE FORM NUMBER
document.getElementById("formID").innerText =
    "ETF-" + Date.now().toString().slice(-6);

// IMAGE PREVIEW HANDLER
function previewImage(event, id) {
    const reader = new FileReader();
    reader.onload = function () {
        document.getElementById(id).src = reader.result;
    };
    reader.readAsDataURL(event.target.files[0]);
}

// ADD MULTIPLE ROWS
let rowCount = 1;

function addRow() {
    rowCount++;
    const table = document.getElementById("equipmentTable").getElementsByTagName("tbody")[0];

    const newRow = document.createElement("tr");

    newRow.innerHTML = `
        <td>${rowCount}</td>
        <td>
            <img class="item-img" id="img${rowCount}" src="">
            <input type="file" class="upload-btn" accept="image/*"
                   onchange="previewImage(event, 'img${rowCount}')">
        </td>
        <td><textarea></textarea></td>
        <td><input type="text"></td>
        <td><textarea></textarea></td>
    `;

    table.appendChild(newRow);
}

// DOWNLOAD AS PDF USING jsPDF
async function downloadPDF() {
    const { jsPDF } = window.jspdf;

    const element = document.getElementById("pdfSection");

    const canvas = await html2canvas(element, { scale: 2 });
    const imgData = canvas.toDataURL("image/png");

    let pdf = new jsPDF("p", "mm", "a4");
    let imgWidth = 210;
    let imgHeight = canvas.height * imgWidth / canvas.width;

    pdf.addImage(imgData, "PNG", 0, 0, imgWidth, imgHeight);

    pdf.save("Equipment_Transfer_Form.pdf");
}
</script>

</body>
</html>
